import{useEffect as n}from"react";import{useTable as j}from"@refinedev/core";import{useReactTable as G,getCoreRowModel as J}from"@tanstack/react-table";import{useEffect as A,useRef as Q}from"react";var F=()=>{let o=Q(!0);return A(()=>{o.current=!1},[]),o.current};function K({refineCoreProps:{hasPagination:o=!0,...f}={},initialState:S={},...O}){var g,C,x;let m=F(),b=j({...f,hasPagination:o}),B=o===!1?"off":"server",R=((C=(g=f.pagination)==null?void 0:g.mode)!=null?C:B)!=="off",{tableQueryResult:{data:i},current:H,setCurrent:l,pageSize:h,setPageSize:v,sorters:z,setSorters:U,filters:I,setFilters:L,pageCount:w}=b,p=[];I.forEach(e=>{e.operator!=="or"&&e.operator!=="and"&&"field"in e&&p.push(e)});let E=G({getCoreRowModel:J(),data:(x=i==null?void 0:i.data)!=null?x:[],initialState:{pagination:{pageIndex:H-1,pageSize:h},sorting:z.map(e=>({id:e.field,desc:e.order==="desc"})),columnFilters:p.map(e=>({id:e.field,operator:e.operator,value:e.value})),...S},pageCount:w,manualPagination:!0,manualSorting:!0,manualFiltering:!0,...O}),{state:M,columns:k}=E.options,{pagination:u,sorting:t,columnFilters:s}=M,{pageIndex:d,pageSize:T}=u!=null?u:{};return n(()=>{d!==void 0&&l(d+1)},[d]),n(()=>{T!==void 0&&v(T)},[T]),n(()=>{t!==void 0&&(U(t==null?void 0:t.map(e=>({field:e.id,order:e.desc?"desc":"asc"}))),t.length>0&&R&&!m&&l(1))},[t]),n(()=>{let e=[];s==null||s.map(r=>{var P,y,D;let a=(D=r.operator)!=null?D:(y=(P=k.find(q=>q.id===r.id))==null?void 0:P.meta)==null?void 0:y.filterOperator;e.push({field:r.id,operator:a!=null?a:Array.isArray(r.value)?"in":"eq",value:r.value})});let c=p.filter(r=>!e.some(a=>r.field===a.field&&r.operator===a.operator));c==null||c.map(r=>{e.push({field:r.field,operator:r.operator,value:void 0})}),L(e),e.length>0&&R&&!m&&l(1)},[s]),{...E,refineCore:b}}export{K as useTable};
//# sourceMappingURL=index.js.map